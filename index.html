<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leave a tip?</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1 id="heading">Leave a tip?</h1>
        
        <div class="tip-buttons">
            <button class="tip-btn fly-button">15%</button>
            <button class="tip-btn fly-button">20%</button>
            <button class="tip-btn clickable-btn">100%</button>
        </div>
        
        <button class="custom-btn fly-button">Custom</button>
        
        <div id="message" class="message"></div>
    </div>
    
    <script>
        // Get query parameter 'name' from URL
        const urlParams = new URLSearchParams(window.location.search);
        const name = urlParams.get('name');
        
        // Update heading if name parameter exists
        if (name) {
            document.getElementById('heading').textContent = `Leave a tip for ${name}?`;
        }
        
        // Add fly-away effect to buttons that should fly away
        const flyButtons = document.querySelectorAll('.fly-button');
        
        // Track percentage for 15% and 20% buttons using the button element as key
        const percentageTracker = new WeakMap();
        
        flyButtons.forEach(button => {
            // Store initial percentage
            const match = button.textContent.match(/\d+/);
            if (match) {
                percentageTracker.set(button, parseInt(match[0]));
            }
            
            button.addEventListener('mouseenter', function() {
                // Generate random direction
                const directions = [
                    { x: '200vw', y: '-100vh' },  // Top right
                    { x: '-200vw', y: '-100vh' }, // Top left
                    { x: '200vw', y: '100vh' },   // Bottom right
                    { x: '-200vw', y: '100vh' },  // Bottom left
                    { x: '0', y: '-200vh' },      // Straight up
                    { x: '0', y: '200vh' }        // Straight down
                ];
                
                const randomDirection = directions[Math.floor(Math.random() * directions.length)];
                
                // Set CSS variables for animation
                button.style.setProperty('--fly-x', randomDirection.x);
                button.style.setProperty('--fly-y', randomDirection.y);
                
                // Add fly-away class
                button.classList.add('fly-away');
                
                // Reset after animation
                setTimeout(() => {
                    button.classList.remove('fly-away');
                    button.style.removeProperty('--fly-x');
                    button.style.removeProperty('--fly-y');
                    
                    // Update percentage for 15% and 20% buttons (tip-btn class)
                    if (button.classList.contains('tip-btn')) {
                        let currentValue = percentageTracker.get(button) || 0;
                        currentValue += 5;
                        percentageTracker.set(button, currentValue);
                        button.textContent = currentValue + '%';
                    }
                }, 1000);
            });
        });
        
        // Handle 25% button click
        const clickableBtn = document.querySelector('.clickable-btn');
        clickableBtn.addEventListener('click', function() {
            const messageDiv = document.getElementById('message');
            const heading = document.getElementById('heading');
            const tipButtons = document.querySelector('.tip-buttons');
            const customBtn = document.querySelector('.custom-btn');
            
            // Hide heading and buttons
            heading.style.display = 'none';
            tipButtons.style.display = 'none';
            customBtn.style.display = 'none';
            
            // Show random cheeky message
            const messages = [
                "That's so generous of you!",
                "You're the best!",
                "I knew you'd come around!",
                "Finally!",
                "Now we're talking!",
                "You're too kind!",
                "I always believed in you!",
                "Worth the wait!",
                "My hero! ðŸŽ‰",
                "Knew you couldn't resist!"
            ];
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            messageDiv.textContent = randomMessage;
            messageDiv.style.display = 'block';
        });
    </script>
</body>
</html>
